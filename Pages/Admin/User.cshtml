@page
@model Plantpedia.Pages.Admin.UsersModel
@{
    Layout = "_Layout-Admin";
    ViewData["Title"] = "Quản lý người dùng";
}

@section Styles {
    <link rel="stylesheet" href="~/css/user-page.css" asp-append-version="true" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
}

<div class="admin-users-container">
    <!-- ============================================
         HERO HEADER WITH GRADIENT
         ============================================ -->
    <div class="hero-header">
        <div class="hero-content">
            <div class="hero-left">
                <div class="hero-icon">
                    <i class="fas fa-users"></i>
                </div>
                <div class="hero-text">
                    <h1 class="hero-title">Quản lý người dùng</h1>
                    <p class="hero-subtitle">Quản lý thành viên & phân quyền hệ thống</p>
                </div>
            </div>
            <div class="hero-actions">
                <button class="btn-hero btn-create" id="btnCreateUser">
                    <i class="fas fa-plus"></i>
                    <span class="btn-text">Thêm người dùng</span>
                </button>
            </div>
        </div>
    </div>

    <!-- ============================================
         STATISTICS CARDS
         ============================================ -->
    <div class="stats-grid">
        <div class="stat-card stat-card-primary">
            <div class="stat-icon-wrapper">
                <div class="stat-icon">
                    <i class="fas fa-users"></i>
                </div>
            </div>
            <div class="stat-content">
                <div class="stat-value" id="activeUsers">0</div>
                <div class="stat-label">Tổng người dùng</div>
            </div>
            <div class="stat-sparkline"></div>
        </div>

        <div class="stat-card stat-card-success">
            <div class="stat-icon-wrapper">
                <div class="stat-icon">
                    <i class="fas fa-user-check"></i>
                </div>
            </div>
            <div class="stat-content">
                <div class="stat-value" id="activeCount">0</div>
                <div class="stat-label">Đang hoạt động</div>
            </div>
        </div>

        <div class="stat-card stat-card-warning">
            <div class="stat-icon-wrapper">
                <div class="stat-icon">
                    <i class="fas fa-user-clock"></i>
                </div>
            </div>
            <div class="stat-content">
                <div class="stat-value" id="suspendedCount">0</div>
                <div class="stat-label">Tạm khóa</div>
            </div>
        </div>

        <div class="stat-card stat-card-danger">
            <div class="stat-icon-wrapper">
                <div class="stat-icon">
                    <i class="fas fa-user-times"></i>
                </div>
            </div>
            <div class="stat-content">
                <div class="stat-value" id="deletedCount">0</div>
                <div class="stat-label">Đã xóa</div>
            </div>
        </div>
    </div>

    <!-- ============================================
         SEARCH & FILTERS BAR
         ============================================ -->
    <div class="search-filters-bar">
        <div class="search-container">
            <div class="search-box">
                <i class="fas fa-search search-icon"></i>
                <input type="text"
                       class="search-input"
                       id="globalSearch"
                       placeholder="Tìm kiếm username, email, tên người dùng...">
                <button class="search-clear" id="btnSearchClear" style="display: none;">
                    <i class="fas fa-times"></i>
                </button>
            </div>
        </div>

        <!-- Quick Filter Pills -->
        <div class="quick-filters">
            <button class="filter-pill active" data-filter="all">
                <i class="fas fa-layer-group"></i>
                <span>Tất cả</span>
            </button>
            <button class="filter-pill" data-filter="active">
                <i class="fas fa-check-circle"></i>
                <span>Hoạt động</span>
            </button>
            <button class="filter-pill" data-filter="suspended">
                <i class="fas fa-pause-circle"></i>
                <span>Tạm khóa</span>
            </button>
            <button class="filter-pill" data-filter="deleted">
                <i class="fas fa-trash-alt"></i>
                <span>Đã xóa</span>
            </button>
        </div>
    </div>

    <!-- ============================================
         USERS TABLE
         ============================================ -->
    <div class="content-section">
        <div class="section-header">
            <h2 class="section-title">Danh sách người dùng</h2>
        </div>

        <div class="users-table-wrap">
            <table class="users-table" id="usersTable" role="table" aria-label="Danh sách người dùng">
                <thead>
                    <tr>
                        <th>Người dùng</th>
                        <th>Email</th>
                        <th>Trạng thái</th>
                        <th>Tạo lúc</th>
                        <th>Đăng nhập cuối</th>
                        <th class="text-start">Thống kê</th>
                        <th style="width:1%">Hành động</th>
                    </tr>
                </thead>
                <tbody id="userTableBody"><!-- JS sẽ render vào đây --></tbody>
            </table>
        </div>

        <!-- Loading State -->
        <div class="loading-state" id="loadingState" style="display: none;">
            <div class="loading-spinner">
                <div class="spinner"></div>
            </div>
            <p>Đang tải dữ liệu...</p>
        </div>

        <!-- Empty State -->
        <div class="empty-state" id="emptyState" style="display: none;">
            <div class="empty-icon">
                <i class="fas fa-users-slash"></i>
            </div>
            <h3 class="empty-title">Không tìm thấy người dùng</h3>
            <p class="empty-description">
                Không có người dùng nào phù hợp với tiêu chí tìm kiếm của bạn.
                <br />Hãy thử thay đổi bộ lọc hoặc từ khóa tìm kiếm.
            </p>
            <button class="btn-empty-action" id="btnResetFilters">
                <i class="fas fa-redo"></i>
                Đặt lại bộ lọc
            </button>
        </div>

        <!-- Pagination -->
        <div class="pagination-wrapper" id="paginationContainer">
            <!-- Pagination will be dynamically generated -->
        </div>
    </div>
</div>

<!-- ============================================
     USER FORM MODAL (CREATE/EDIT)
     ============================================ -->
<div class="modal fade" id="userFormModal" tabindex="-1" aria-labelledby="userFormModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <!-- Content will be dynamically generated -->
        </div>
    </div>
</div>

@section Scripts {
    <script type="module" src="~/js/user-admin-page/main-user-admin.js"></script>
    <script type="module" src="~/js/user-admin-page/core/ui-enhancements.js" asp-append-version="true"></script>
}
